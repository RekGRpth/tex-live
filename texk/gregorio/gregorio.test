#! /bin/sh
# $Id$
# Copyright 2016 Karl Berry <tex-live@tug.org>
# Copyright 2015 Peter Breitenlohner <tex-live@tug.org>
# You may freely use, modify and/or distribute this file.

TEXMFCNF=$srcdir/../kpathsea

export TEXMFCNF

DOCSRC=$srcdir/$GREGORIO_TREE/doc

#
# Does FILENAME_VERSION have a value here? If it does, the
# next line is not needed
FILENAME_VERSION=5_0_0-rc1

gregorio=gregorio-$FILENAME_VERSION

failed=

echo "*** gregorio --version" \
	&& ./$gregorio --version \
	&& echo && echo "gregorio-version tests OK" && echo \
	|| failed="$failed gregorio-version"

echo "*** gregorio --help" \
	&& ./$gregorio --help \
	&& echo && echo "gregorio-help tests OK" && echo \
	|| failed="$failed gregorio-help"

echo "*** gregorio -o factus.gtex factus.gabc" \
	&& ./$gregorio -o factus.gtex $DOCSRC/factus.gabc \
	&& echo && echo "gregorio-factus tests OK" && echo \
	|| failed="$failed gregorio-factus"

echo "*** gregorio -o veni.gtex veni.gabc" \
	&& ./$gregorio -o veni.gtex $DOCSRC/veni.gabc \
	&& echo && echo "gregorio-veni tests OK" && echo \
	|| failed="$failed gregorio-veni"

test -z "$failed" && exit 0
echo
echo "failed tests:$failed"
exit 1
